import ctypes
from ctypes import Structure, Union

CONFRONT_STATE_ADDR = 0x600000000000
WEAPON_MEM_POOL = 0x610000000000
MAX_WEAPON_IDX = 200
WEAPON_ARRAY_SIZE = 0xc80

SLOT_NONE = 0xffffffffffffffff
MAX_NAME_LEN = 0x100
MAX_DESC_LEN = 0x100

STAGE_MIN = 0
STAGE_MAX = 2000
LOC_NONE = 0xffffffffffffffff

IDLE = 0x00
STARTBATTLE = 0x01
RETREAT = 0x02
CRAFTWEAPON = 0x03
SWITCHWEAPON = 0x04
ENHANCEWEAPON = 0x05
DISPOSEWEAPON = 0x06
ATTACK = 0x07
DEFEND = 0x08
MOVE = 0x09
GIVEUP = 0xff

class confrontState(Structure):
    _pack_ = 1
    _fields_ = [
        ('unicornRand', ctypes.c_ulong),
        ('isConfront', ctypes.c_ulong),
        ('unicornStage', ctypes.c_ulong),
        ('unicornHP', ctypes.c_ulong),
        ('unicornAttack', ctypes.c_ulong),
        ('unicornDefense', ctypes.c_ulong),
        ('unicornState', ctypes.c_ulong),
        ('unicornAttribute', ctypes.c_ulong),
        ('unicornCD', ctypes.c_ulong),
        ('unicornDefenseGauge', ctypes.c_ulong),
        ('unicornLoc', ctypes.c_ulong),
        ('unicornAttackSourceLoc', ctypes.c_ulong),
        ('unicornAttackBoxLoc', ctypes.c_ulong),
        ('adventurerHP', ctypes.c_ulong),
        ('adventurerAttack', ctypes.c_ulong),
        ('adventurerDefense', ctypes.c_ulong),
        ('adventurerState', ctypes.c_ulong),
        ('adventurerCD', ctypes.c_ulong),
        ('adventurerDefenseGauge', ctypes.c_ulong),
        ('adventurerLoc', ctypes.c_ulong),
        ('adventurerAttackSourceLoc', ctypes.c_ulong),
        ('adventurerAttackBoxLoc', ctypes.c_ulong),
        ('adventurerWeaponIdx', ctypes.c_ulong),
        ('adventurerName', ctypes.c_uint8 * MAX_NAME_LEN),
        ('adventurerDesc', ctypes.c_uint8 * MAX_DESC_LEN),
        ('adventurerWeapons', ctypes.c_ulong * MAX_WEAPON_IDX),
    ]

class weaponEntry(Structure):
    _pack_ = 1
    _fields_ = [
        ('ptr', ctypes.c_ulong),
        ('size', ctypes.c_ulong),
    ]

class weapon(Structure):
    _pack_ = 1
    _fields_ = [
        ('level', ctypes.c_ulong),
        ('attack', ctypes.c_ulong),
        ('defense', ctypes.c_ulong),
        ('attribute', ctypes.c_ulong),
        ('CD', ctypes.c_ulong),
        ('range', ctypes.c_ulong),
        ('delta', ctypes.c_ulong),
        ('movespeed', ctypes.c_ulong),
        ('name', ctypes.c_uint8 * MAX_NAME_LEN),
        ('desc', ctypes.c_uint8 * MAX_DESC_LEN),
    ]

class startBattleStruct(Structure):
    _pack_ = 1
    _fields_ = [
        ('namelen', ctypes.c_ulong),
        ('desclen', ctypes.c_ulong),
        ('name', ctypes.c_uint8 * MAX_NAME_LEN),
        ('desc', ctypes.c_uint8 * MAX_DESC_LEN),
    ]

class craftWeaponStruct(Structure):
    _pack_ = 1
    _fields_ = [
        ('namelen', ctypes.c_ulong),
        ('desclen', ctypes.c_ulong),
        ('attack', ctypes.c_ulong),
        ('defense', ctypes.c_ulong),
        ('attribute', ctypes.c_ulong),
        ('CD', ctypes.c_ulong),
        ('range', ctypes.c_ulong),
        ('delta', ctypes.c_ulong),
        ('movespeed', ctypes.c_ulong),
        ('name', ctypes.c_uint8 * MAX_NAME_LEN),
        ('desc', ctypes.c_uint8 * MAX_DESC_LEN),
    ]

class switchWeaponStruct(Structure):
    _pack_ = 1
    _fields_ = [
        ('targetIdx', ctypes.c_ulong),
    ]

class enhanceWeaponStruct(Structure):
    _pack_ = 1
    _fields_ = [
    ]

class disposeWeaponStruct(Structure):
    _pack_ = 1
    _fields_ = [
        ('targetIdx', ctypes.c_ulong),
    ]

class attackStruct(Structure):
    _pack_ = 1
    _fields_ = [
        ('level', ctypes.c_ulong),
    ]

class defendStruct(Structure):
    _pack_ = 1
    _fields_ = [
        ('level', ctypes.c_ulong),
    ]

class moveStruct(Structure):
    _pack_ = 1
    _fields_ = [
        ('direction', ctypes.c_ulong),
    ]

class action(Union):
    _pack_ = 1
    _fields_ = [
        ('startBattleStruct', startBattleStruct),
        ('craftWeaponStruct', craftWeaponStruct),
        ('switchWeaponStruct', switchWeaponStruct),
        ('enhanceWeaponStruct', enhanceWeaponStruct),
        ('disposeWeaponStruct', disposeWeaponStruct),
        ('attackStruct', attackStruct),
        ('defendStruct', defendStruct),
        ('moveStruct', moveStruct),
    ]

class actionStruct(Structure):
    _pack_ = 1
    _fields_ = [
        ('action', ctypes.c_ulong),
        ('stru', action),
    ]

